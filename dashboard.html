<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard â€“ Silky Road</title>
  <link rel="icon" href="/favicon.png" />
  <link rel="stylesheet" href="/css/styles.css" />
</head>

<body>

<!-- ============================================== -->
<!-- ğŸ”’ AUTH PROTECTION â€” RUNS BEFORE PAGE LOAD     -->
<!-- ============================================== -->
<script type="module">
  import { supabase } from "/js/auth.js";

  const { data } = await supabase.auth.getSession();

  if (!data.session) {
    // NOT LOGGED IN â€” redirect to login
    window.location.replace("/login.html");
  }
</script>

<!-- HEADER -->
<div id="header-root"></div>

<!-- ============================================== -->
<!-- DASHBOARD LAYOUT                               -->
<!-- ============================================== -->

<div class="sr-app-shell">

  <!-- SIDEBAR -->
  <aside class="sr-side-nav" id="sideNav">
    <div class="sr-side-nav-inner">

      <div class="sr-side-logo">
        <a href="/index.html">
          <img src="/logo.png" class="sr-side-logo-img" alt="Silky Road" />
        </a>
      </div>

      <nav class="sr-side-nav-menu">

        <a class="sr-side-link is-active" href="/dashboard.html">
          <span class="sr-side-icon">ğŸ </span> Dashboard
        </a>

        <a class="sr-side-link" href="/upload.html">
          <span class="sr-side-icon">â¬†ï¸</span> Upload Product
        </a>

        <a class="sr-side-link" href="/library.html">
          <span class="sr-side-icon">ğŸ“š</span> My Library
        </a>

        <a class="sr-side-link" href="/marketplace.html">
          <span class="sr-side-icon">ğŸ›’</span> Marketplace
        </a>

      </nav>

      <div class="sr-side-nav-footer">
        <button class="sr-side-link" id="logout-dashboard">
          <span class="sr-side-icon">ğŸšª</span> Log out
        </button>
      </div>

    </div>
  </aside>

  <!-- BACKDROP FOR MOBILE SIDEBAR -->
  <div class="sr-side-backdrop"></div>

  <!-- MAIN CONTENT -->
  <main class="sr-app-main">
    <div class="sr-app-main-inner">
      
      <h1 class="sr-app-page-title">Dashboard</h1>
      <p class="sr-app-intro">Manage your products, sales, and account.</p>

      <div class="sr-app-cards">

        <div class="sr-app-card">
          <h2>Your Products</h2>
          <p>Upload and manage all your digital items.</p>
          <a href="/upload.html" class="sr-app-btn sr-app-btn-gold">Add Product</a>
        </div>

        <div class="sr-app-card">
          <h2>Sales & Orders</h2>
          <p>View purchase history and order details.</p>
          <a href="/dashboard.html" class="sr-app-btn sr-app-btn-outline">View Orders</a>
        </div>

        <div class="sr-app-card">
          <h2>Library</h2>
          <p>Your downloaded + purchased items.</p>
          <a href="/library.html" class="sr-app-btn sr-app-btn-outline">Go to Library</a>
        </div>

      </div>

    </div>
  </main>

</div>

<!-- FOOTER -->
<div id="footer-root"></div>

<!-- MODULE SCRIPTS -->
<script type="module" src="/js/header-main.js"></script>
<script type="module" src="/js/footer.js"></script>

<!-- LOGOUT HANDLER -->
<script type="module">
  import { supabase } from "/js/auth.js";

  document.getElementById("logout-dashboard").addEventListener("click", async () => {
    await supabase.auth.signOut();

    // clear old cached auth UI
    localStorage.clear();
    sessionStorage.clear();

    window.location.replace("/login.html");
  });
</script>

</body>
</html>
